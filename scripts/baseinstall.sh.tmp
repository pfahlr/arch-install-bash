#!/usr/bin/bash

source _vars.inc.sh

#install base packages

pacstrap /mnt base

#create the fstab
genfstab -L -p /mnt >> /mnt/etc/fstab

cat /mnt/etc/fstab

sed -i s+LABEL=swap+/dev/mapper/swap+ /mnt/etc/fstab_labels

echo "cryptswap	/dev/disk/by-partlabel/cryptswap	/dev/urandom	swap,offset=2048,cipher=aes-xts-plain64,size=256" >> /etc/cryptswap

systemd-nspawn -bD /mnt

#add locales to end of locales.gen file

echo "en_US.UTF-8 UTF-8" >> locale.gen
echo "en_US.ISO-8859-1 ISO-8859-1" >> locale.gen
echo "en_US.IBM437 IBM850" >> locale.gen
echo "en_US.IBM850 IBM850" >> locale.gen


locale-gen

echo "LOCALE=en_US.UTF-8" > /etc/locale.conf

timedatectl set-ntp 1

timedatectl list-timezones

timedatectl set-timezone America/Detroit


